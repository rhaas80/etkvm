
README: CIGR_sync 

This script automates transfers of a user specified set of data files to a Petashare site from a local or production machine. The script is also capable of attaching metadata for the simulation to the data.  

The script uses pcommands to attach metadata and transfer files to a specified Petashare site.
pcommands have been installed and have execute access user {home of that machine}/spothn1/pcommands-2.0
If the user does not specify a local installation, the deafault installation will be used. How ever ever user has to set the enviroment variables before using the script. Setting the environment is discussed below in detail.

The latest version of Pcommands is available from
http://www.cct.lsu.edu/~akturk/petashare/downloads/pcommands/pcommands-2.0.tar.gz.  

Instructions to install pcommands are available at: 
http://www.cct.lsu.edu/~akturk/petashare/pcommands-manual(2.0).php


This script will work on any machine from which the Petashare sites can be accessed.  At present Petashare can be accessed from all the TeraGrid and LONI resources except for the Frost machine on the TeraGrid.  

Setting up pcommands environment (if user has not installed pcommands )

    * Please create a .pcommands directory in your home
    * Get the CIGR_environment file from svn( which is under petashare ) Change the name of the it to ".pcommandsEnv" and put the file inside the directory.
    * run pinit from {path to pcommands on that machine} and enter password ( Please contact Dr.Allen for password ).

To find path to pcommands on that machine please do the following:
$finger spothn1

This will provide information about the user "spothn1", the users home will be provided under Directory:
append /pcommands-2.0/bin to it.


ex:
$ finger spothn1
Login: spothn1                          Name: Sreekanth Pothanis
Directory: /u/ac/spothn1                Shell: /bin/tcsh

Now the path to pcommands will be /u/ac/spothn1/pcommands-2.0/


Usage: 

CIGR_sync  -m <metadata file> -f <data file> -w <path to pcommands> 

Where 

<data file> is the path to the file containing a list of data files that are to be uploaded to the CIGR archive. Filenames can correspond to either single files or directories. If a directory is specified all the files in that directory will be uploaded. File names should be provided with one file per line separated by a new line character. This is a compulsory argument and can have comments starting with # 

<metadata_file> is the path to the file containing metadata that should be attached to the archived data (It is not compulsory argument). Metadata must be provided in the format NAME=VALUE  

There can be comments starting with #, however if the there are newline terminators in the VALUE it will not be attached. (This is will be modified soon ) 

<path to pcommands> can be used to indicate the path of Pcommands ifusers want to use a local installation of pcommands instead of the default installation. 

Upon execution the script creates a directory in the CIGR archive in Petashare (the directory name has the format TS_PID_USERNAME_HOSTNAME), attaches the metadata specified by metadata_file and transfers all the files specified in fileslist to it. 

After each successful transfer the script will output the location of the log file for that transfer. If a transfer fails because of a network error or some other error restarting the script will prompt you to resume that transfer. It will not re-transfer if transfer failed due to a non-existing file. 

To do: 

    * provide interface/client tool for searching for and retrieving archived data
    * optimize data transfer
    * use stork scheduler instead of pcommands for data transfer

 

Please report suggestions/bugs to sreekanth@cct.lsu.edu.

